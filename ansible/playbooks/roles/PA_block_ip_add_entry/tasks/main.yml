# - name: Create address object
#   paloaltonetworks.panos.panos_address_object:
#     provider: '{{ palo_provider }}'
#     name: '{{ object_name }}'
#     value: '{{ source_ip }}'
#     description: 'made by ansible'

- name: Create object group 'block_from_outside'
  paloaltonetworks.panos.panos_address_group:
    provider: '{{ palo_provider }}'
    name: 'Client_managed_Block_Group'
    static_value: "{{object_name}}"
    state: present

- name: drop from outside
  paloaltonetworks.panos.panos_security_rule:
    provider: '{{ palo_provider }}'
    rule_name: 'Client Managed Block List'
    description: 'Made by AWX'
    source_zone: ['OUTSIDE']
    source_ip: ['Client_managed_Block_Group']
    destination_zone: ['any']
    destination_ip: ['any']
    application: ['any']
    action: 'drop'
    location: top
    log_end: true
