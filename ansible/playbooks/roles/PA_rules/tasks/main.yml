---

- name: commit var
  set_facts:
    commit: false

- name: Create object 'Test-One'
  paloaltonetworks.panos.panos_address_object:
    provider: '{{ palo_provider }}'
    name: '{{ object_name }}'
    value: '{{ source_ip }}'
    description: 'made by ansible'

- name: Create object 'Test-One-NAT'
  paloaltonetworks.panos.panos_address_object:
    provider: '{{ palo_provider }}'
    name: '{{ object_name }}-NAT'
    value: '{{ NAT_ip }}'
    description: 'made by ansible'

- name: add a nat rule
  paloaltonetworks.panos.panos_nat_rule2:
    provider: '{{ palo_provider }}'
    name: '{{ object_name }} OUTSIDE'
    description: 'Made by Ansible'
    nat_type: 'ipv4'
    from_zones: ['INSIDE-PA-203']
    to_zones: ['OUTSIDE']
    to_interface: 'any'
    service: 'any'
    source_addresses: ['{{ object_name }}']
    destination_addresses: ['any']
    source_translation_type: 'static-ip'
    source_translation_static_translated_address: '{{ object_name }}-NAT'
    source_translation_static_bi_directional: true

- name: commit candidate configs on firewall
  paloaltonetworks.panos.panos_commit_firewall:
    provider: '{{ palo_provider }}'
  when: commit == true